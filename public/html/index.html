<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Linh Hong">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script>

            //let blob = new Blob(["<html>...</html>"], {type: 'text/html'});

            //console.log(blob);

            /* let hello = new Uint8Array([72, 101, 108, 108, 111]);
            let blob = new Blob([hello, ' ', 'world'], {type: 'text/plain'});
            console.log(blob);

            let decoder = new TextDecoder();
            console.log(blob.slice(0, 4, 'text/plain')); */


/* 
            const TYPE_OF_VIEW = Uint8Array; //Float64Array;//Uint16Array;//Uint8Array;//Uint32Array;

            let uint8Array = new TYPE_OF_VIEW([0, 228, 189, 160, 229, 165, 189, 0]);
                //[72, 101, 108, 108, 111]);

            let decoder = new TextDecoder();
            console.log(decoder.decode(uint8Array.subarray(1, -1)));


            let encoder = new TextEncoder();
            uint8Array = encoder.encode("Hello");
            console.log(uint8Array);

            console.log(encoder.encode("你好"));
 */

/*            function concat(arrays) {
                if (arrays.length <= 0) return [];
                const total_len = arrays.reduce((sum, item) => sum + item.length, 0);
                console.log(total_len);
                let view = new TYPE_OF_VIEW(total_len);

                let offset = 0;
                for (let array of arrays) {
                    view.set(array, offset);
                    offset += array.length;
                }

                return view;

            }

            console.log(`Testing...`);

            const result = concat([[1, 3, 5, 7], [6, 2, 5], [12, 43]]);
            console.log(result);
*/

/*
            let buffer = new ArrayBuffer(9);
            console.log(buffer.byteLength);
            console.log(buffer);

            
            let view = new TYPE_OF_VIEW(buffer);
            view.concat = function(arrays) {
                //console.log(`${view.length} - ${arrays.length}`);
                let newView = new TYPE_OF_VIEW(new Array(view.length + arrays.length));
                newView.set(view);
                newView.set(arrays, view.length);
                //sconsole.log(newView.length);
                //console.log(newView);
                return newView;
            }



            for (let index = 0; index < view.length; index++) {
                view[index] = 30;
            }
            //console.log(view);
            const result = view.concat([4, 67, 25]);
            console.log(result);


            
            console.log(`${TYPE_OF_VIEW.name} - Number of bytes per element: ${TYPE_OF_VIEW.BYTES_PER_ELEMENT}`);
            console.log(`length of this view: ${view.length}`);
            console.log(`size in bytes: ${view.byteLength}`);

            view[0] = 123456;
            for (let num of view) {
                console.log(num);
            }
            */
        </script>
    </head>
    <body>
        <input type="file" onchange="handle(this)">
<!---        <img src="data:image/png;base64,R0lGODlhDAAMAKIFAF5LAP/zxAAAANyuAP/gaP///wAAAAAAACH5BAEAAAUALAAAAAAMAAwAAAMlWLPcGjDKFYi9lxKBOaGcF35DhWHamZUW0K4mAbiwWtuf0uxFAgA7">
        <a download="user.json" href='#' id="link">Download</a>
-->
        <script>
            function handle(input) {
                let file = input.files[0];
                let reader = new FileReader();
                reader.readAsText(file);

                reader.onload = function() {
                    const content = reader.result;
                    const json = JSON.parse(content);
                    console.log(json);
                }

                reader.onerror = function() {
                    console.log(reader.error);
                }
                
                
                /*
                console.log(input.files);


                console.log(`Filename: ${file.name}`);
                console.log(`Last modified: ${file.lastModified}`);*/
            }


/*
            let user = {
                name: 'Hong Gia Linh',
                age: 45
            }

            let link = document.createElement('a');
            link.download = 'user.json';

            let blob = new Blob([JSON.stringify(user, null, 2)], {type: 'application/json'});
            let reader = new FileReader();
            reader.readAsDataURL(blob);

            reader.onload = function() {
                link.href = reader.result; // data url
                //link.click();
            };
*/


            
//            link.href = URL.createObjectURL(blob);

//            link.click();
            //URL.revokeObjectURL(link.href);
            </script>
    </body>
</html>